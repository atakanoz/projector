#!/bin/bash




# If current folder is not a specific project folder
if [[ -z $SLUG ]] && [[ -z $PROJECTDIR ]]; then


	# Get project name from args
	if [[ ! -z $1 ]]; then

		SLUG=$1

	else


		# Ask for the project name
		read -ep "Project name (site-name): " SLUG
		while [[ -z $SLUG ]]; do
			read -ep "Project name (site-name): " SLUG
		done


	fi


	# Project directory
	PROJECTDIR="${BASEDIR}/${SLUG}"


	# Check if the folder not exists
	if [[ ! -d $PROJECTDIR ]]; then

		echo -e "${RED}Project folder doesn't exist.${RESET}"
		exit

	fi


fi




# Check if already installed
if [[ -f "$PROJECTDIR/.env" ]]; then

	source "$PROJECTDIR/.env"

	if [[ $IP != "127.0.0.1" ]]; then

		echo -e "${RED}Project is already installed.${RESET}"
		exit

	fi


fi




# RUN THE SERVER
(
	cd $PROJECTDIR
	docker-compose -f "$BUILDERDIR/docker-compose.yml" up -d
	docker-compose -f "$BUILDERDIR/docker-compose.yml" down
)



echo -e "Installing '${SLUG}' project ... ${GREEN}done${RESET}"
